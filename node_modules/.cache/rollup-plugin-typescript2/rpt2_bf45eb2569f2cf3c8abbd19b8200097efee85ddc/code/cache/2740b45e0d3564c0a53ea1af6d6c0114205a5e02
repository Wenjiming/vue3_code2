{"code":"import { isFunction } from \"@vue/shared\";\nimport { effect } from './effect';\nexport function computed(getterOrOptions) {\n    // 1)getter函数 2）对象\n    let getter, setter;\n    if (isFunction(getterOrOptions)) {\n        getter = getterOrOptions;\n        setter = () => {\n            console.warn(`computed value muse be readonly`);\n        };\n    }\n    else {\n        getter = getterOrOptions.get;\n        setter = getterOrOptions.set;\n    }\n    return new ComputedRefImpl(getter, setter);\n}\nclass ComputedRefImpl {\n    setter;\n    _dirty = true; // 默认获取值时候执行\n    _value;\n    effect; // effect 依赖\n    constructor(getter, setter) {\n        this.setter = setter;\n        this.effect = effect(getter, {\n            lazy: true,\n            sch: () => {\n                if (!this._dirty)\n                    this._dirty = true;\n                console.log(this._dirty);\n            }\n        }); // 默认不执行\n    }\n    get value() {\n        console.log('get-value');\n        if (this._dirty) {\n            this._dirty = false; // 缓存机制\n            return this.effect();\n        }\n    }\n    set value(newVal) {\n        this.setter(newVal);\n    }\n}\n//# sourceMappingURL=computed.js.map","references":["D:/own-demo/exercise/vue3-code/新建文件夹/vue3_code2/packages/shared/src/index.ts","D:/own-demo/exercise/vue3-code/新建文件夹/vue3_code2/packages/reactivity/src/effect.ts"],"map":"{\"version\":3,\"file\":\"computed.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/reactivity/src/computed.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,aAAa,CAAC;AACzC,OAAQ,EAAE,MAAM,EAAE,MAAM,UAAU,CAAA;AAClC,MAAM,UAAU,QAAQ,CAAC,eAAe;IACtC,kBAAkB;IAClB,IAAI,MAAM,EAAC,MAAM,CAAC;IAClB,IAAI,UAAU,CAAC,eAAe,CAAC,EAAE;QAC/B,MAAM,GAAG,eAAe,CAAC;QACzB,MAAM,GAAG,GAAG,EAAE;YACZ,OAAO,CAAC,IAAI,CAAC,iCAAiC,CAAC,CAAA;QACjD,CAAC,CAAA;KACF;SAAM;QACL,MAAM,GAAG,eAAe,CAAC,GAAG,CAAA;QAC5B,MAAM,GAAG,eAAe,CAAC,GAAG,CAAA;KAC7B;IACD,OAAO,IAAI,eAAe,CAAC,MAAM,EAAC,MAAM,CAAC,CAAA;AAC3C,CAAC;AACD,MAAM,eAAe;IAIO;IAHnB,MAAM,GAAG,IAAI,CAAC,CAAC,YAAY;IAC3B,MAAM,CAAC;IACP,MAAM,CAAC,CAAC,YAAY;IAC3B,YAAY,MAAM,EAAQ,MAAM;QAAN,WAAM,GAAN,MAAM,CAAA;QAC9B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,EAAE;YAC3B,IAAI,EAAE,IAAI;YACV,GAAG,EAAE,GAAG,EAAE;gBACR,IAAI,CAAC,IAAI,CAAC,MAAM;oBAAE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACrC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;YAC1B,CAAC;SACF,CAAC,CAAA,CAAC,QAAQ;IACb,CAAC;IACD,IAAI,KAAK;QACP,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAA;QACxB,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,GAAG,KAAK,CAAA,CAAC,OAAO;YAC3B,OAAO,IAAI,CAAC,MAAM,EAAE,CAAA;SACrB;IACH,CAAC;IACD,IAAI,KAAK,CAAC,MAAM;QACd,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;IACrB,CAAC;CACF\"}"}
